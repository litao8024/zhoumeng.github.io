
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-7.1.5">
    
    
      
        <title>GoogLeNet - æ·±åº¦å­¦ä¹ ä¸CV</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.bde7dde4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ef6f36e2.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    <script>function __prefix(e){return new URL("../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#34-googlenet" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="æ·±åº¦å­¦ä¹ ä¸CV" class="md-header__button md-logo" aria-label="æ·±åº¦å­¦ä¹ ä¸CV" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            æ·±åº¦å­¦ä¹ ä¸CV
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              GoogLeNet
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="æ·±åº¦å­¦ä¹ ä¸CV" class="md-nav__button md-logo" aria-label="æ·±åº¦å­¦ä¹ ä¸CV" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    æ·±åº¦å­¦ä¹ ä¸CV
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1" type="checkbox" id="__nav_1" >
      
      <label class="md-nav__link" for="__nav_1">
        è¯¾ç¨‹ä»‹ç»
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="è¯¾ç¨‹ä»‹ç»" data-md-level="1">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          è¯¾ç¨‹ä»‹ç»
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../introduction/section1/index.html" class="md-nav__link">
        æ·±åº¦å­¦ä¹ 
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../introduction/section2/index.html" class="md-nav__link">
        è®¡ç®—æœºè§†è§‰ï¼ˆCVï¼‰
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      <label class="md-nav__link" for="__nav_2">
        tensorflowå…¥é—¨
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="tensorflowå…¥é—¨" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          tensorflowå…¥é—¨
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tensorFlow/section1/index.html" class="md-nav__link">
        tensorflowå’Œkerasç®€ä»‹
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tensorFlow/section2/index.html" class="md-nav__link">
        å¿«é€Ÿå…¥é—¨æ¨¡å‹
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      <label class="md-nav__link" for="__nav_3">
        æ·±åº¦ç¥ç»ç½‘ç»œ
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="æ·±åº¦ç¥ç»ç½‘ç»œ" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          æ·±åº¦ç¥ç»ç½‘ç»œ
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../deeplearning/section1/index.html" class="md-nav__link">
        ç¥ç»ç½‘ç»œç®€ä»‹
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../deeplearning/section2/index.html" class="md-nav__link">
        å¸¸è§çš„æŸå¤±å‡½æ•°
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../deeplearning/section3/index.html" class="md-nav__link">
        æ·±åº¦å­¦ä¹ çš„ä¼˜åŒ–æ–¹æ³•
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../deeplearning/section4/index.html" class="md-nav__link">
        æ·±åº¦å­¦ä¹ çš„æ­£åˆ™åŒ–
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../deeplearning/section5/index.html" class="md-nav__link">
        ç¥ç»ç½‘ç»œæ¡ˆä¾‹
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../deeplearning/section6/index.html" class="md-nav__link">
        å·ç§¯ç¥ç»ç½‘ç»œCNN
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" checked>
      
      <label class="md-nav__link" for="__nav_4">
        å›¾åƒåˆ†ç±»
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="å›¾åƒåˆ†ç±»" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          å›¾åƒåˆ†ç±»
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../section1/index.html" class="md-nav__link">
        å›¾åƒåˆ†ç±»ç®€ä»‹
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../section2/index.html" class="md-nav__link">
        AlexNet
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../section3/index.html" class="md-nav__link">
        VGG
      </a>
    </li>
  

          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          GoogLeNet
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="#" class="md-nav__link md-nav__link--active">
        GoogLeNet
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1inception" class="md-nav__link">
    1.Inception å—
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2googlenet" class="md-nav__link">
    2.GoogLeNetæ¨¡å‹
  </a>
  
    <nav class="md-nav" aria-label="2.GoogLeNetæ¨¡å‹">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-b1" class="md-nav__link">
    2.1 B1æ¨¡å—
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-b2" class="md-nav__link">
    2.2 B2æ¨¡å—
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23-b3" class="md-nav__link">
    2.3 B3æ¨¡å—
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#24-b4" class="md-nav__link">
    2.4 B4æ¨¡å—
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#25-b5" class="md-nav__link">
    2.5 B5æ¨¡å—
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    3.æ‰‹å†™æ•°å­—è¯†åˆ«
  </a>
  
    <nav class="md-nav" aria-label="3.æ‰‹å†™æ•°å­—è¯†åˆ«">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21" class="md-nav__link">
    2.1 æ•°æ®è¯»å–
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32" class="md-nav__link">
    3.2 æ¨¡å‹ç¼–è¯‘
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33" class="md-nav__link">
    3.3 æ¨¡å‹è®­ç»ƒ
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#24" class="md-nav__link">
    2.4 æ¨¡å‹è¯„ä¼°
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4" class="md-nav__link">
    4.å»¶ä¼¸ç‰ˆæœ¬
  </a>
  
    <nav class="md-nav" aria-label="4.å»¶ä¼¸ç‰ˆæœ¬">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-inceptionv2" class="md-nav__link">
    4.1 InceptionV2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-inceptionv3" class="md-nav__link">
    4.2 InceptionV3
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../section5/index.html" class="md-nav__link">
        ResNet
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../section6/index.html" class="md-nav__link">
        å›¾åƒå¢å¼ºæ–¹æ³•
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../section7/index.html" class="md-nav__link">
        æ¨¡å‹å¾®è°ƒ
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      <label class="md-nav__link" for="__nav_5">
        ç›®æ ‡æ£€æµ‹
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="ç›®æ ‡æ£€æµ‹" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          ç›®æ ‡æ£€æµ‹
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../objectdection/01.overview/index.html" class="md-nav__link">
        ç›®æ ‡æ£€æµ‹æ¦‚è¿°
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../objectdection/02.RCNN/index.html" class="md-nav__link">
        RCNNç½‘ç»œåŸºç¡€
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../objectdection/03.Faster-RCNN/index.html" class="md-nav__link">
        Faster-RCNNåŸç†ä¸å®ç°
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../objectdection/04.yolo/index.html" class="md-nav__link">
        YOLOç³»åˆ—ç®—æ³•
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../objectdection/05.yoloV3-demo/index.html" class="md-nav__link">
        YOLOV3æ¡ˆä¾‹
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      <label class="md-nav__link" for="__nav_6">
        ç›®æ ‡åˆ†å‰²
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="ç›®æ ‡åˆ†å‰²" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          ç›®æ ‡åˆ†å‰²
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../imageSegmentation/section1/index.html" class="md-nav__link">
        ç›®æ ‡åˆ†å‰²ä»‹ç»
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../imageSegmentation/section2/index.html" class="md-nav__link">
        è¯­ä¹‰åˆ†å‰²ï¼šFCNå’ŒUNet
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../imageSegmentation/section3/index.html" class="md-nav__link">
        UNetæ¡ˆä¾‹
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../imageSegmentation/section4/index.html" class="md-nav__link">
        å®ä¾‹åˆ†å‰²ï¼šMask RCNN
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1inception" class="md-nav__link">
    1.Inception å—
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2googlenet" class="md-nav__link">
    2.GoogLeNetæ¨¡å‹
  </a>
  
    <nav class="md-nav" aria-label="2.GoogLeNetæ¨¡å‹">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-b1" class="md-nav__link">
    2.1 B1æ¨¡å—
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-b2" class="md-nav__link">
    2.2 B2æ¨¡å—
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23-b3" class="md-nav__link">
    2.3 B3æ¨¡å—
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#24-b4" class="md-nav__link">
    2.4 B4æ¨¡å—
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#25-b5" class="md-nav__link">
    2.5 B5æ¨¡å—
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    3.æ‰‹å†™æ•°å­—è¯†åˆ«
  </a>
  
    <nav class="md-nav" aria-label="3.æ‰‹å†™æ•°å­—è¯†åˆ«">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21" class="md-nav__link">
    2.1 æ•°æ®è¯»å–
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32" class="md-nav__link">
    3.2 æ¨¡å‹ç¼–è¯‘
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33" class="md-nav__link">
    3.3 æ¨¡å‹è®­ç»ƒ
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#24" class="md-nav__link">
    2.4 æ¨¡å‹è¯„ä¼°
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4" class="md-nav__link">
    4.å»¶ä¼¸ç‰ˆæœ¬
  </a>
  
    <nav class="md-nav" aria-label="4.å»¶ä¼¸ç‰ˆæœ¬">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-inceptionv2" class="md-nav__link">
    4.1 InceptionV2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-inceptionv3" class="md-nav__link">
    4.2 InceptionV3
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="34-googlenet">3.4 GoogLeNet<a class="headerlink" href="#34-googlenet" title="Permanent link">&para;</a></h1>
<p><strong>å­¦ä¹ ç›®æ ‡</strong></p>
<ul>
<li>çŸ¥é“GoogLeNetç½‘ç»œç»“æ„çš„ç‰¹ç‚¹</li>
<li>èƒ½å¤Ÿåˆ©ç”¨GoogLeNetå®Œæˆå›¾åƒåˆ†ç±»</li>
</ul>
<hr />
<p><img alt="image-20200810100250755" src="../assets/image-20200810100250755.png" /></p>
<p>GoogLeNetçš„åå­—ä¸æ˜¯GoogleNetï¼Œè€Œæ˜¯GoogLeNetï¼Œè¿™æ˜¯ä¸ºäº†è‡´æ•¬LeNetã€‚GoogLeNetå’ŒAlexNet/VGGNetè¿™ç±»ä¾é åŠ æ·±ç½‘ç»œç»“æ„çš„æ·±åº¦çš„æ€æƒ³ä¸å®Œå…¨ä¸€æ ·ã€‚GoogLeNetåœ¨åŠ æ·±åº¦çš„åŒæ—¶åšäº†ç»“æ„ä¸Šçš„åˆ›æ–°ï¼Œå¼•å…¥äº†ä¸€ä¸ªå«åšInceptionçš„ç»“æ„æ¥ä»£æ›¿ä¹‹å‰çš„å·ç§¯åŠ æ¿€æ´»çš„ç»å…¸ç»„ä»¶ã€‚GoogLeNetåœ¨ImageNetåˆ†ç±»æ¯”èµ›ä¸Šçš„Top-5é”™è¯¯ç‡é™ä½åˆ°äº†6.7%ã€‚ã€‚</p>
<h2 id="1inception">1.Inception å—<a class="headerlink" href="#1inception" title="Permanent link">&para;</a></h2>
<p>GoogLeNetä¸­çš„åŸºç¡€å·ç§¯å—å«ä½œInceptionå—ï¼Œå¾—åäºåŒåç”µå½±ã€Šç›—æ¢¦ç©ºé—´ã€‹ï¼ˆInceptionï¼‰ã€‚Inceptionå—åœ¨ç»“æ„æ¯”è¾ƒå¤æ‚ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img alt="image-20200810101055766" src="../assets/image-20200810101055766.png" /></p>
<p>Inceptionå—é‡Œæœ‰4æ¡å¹¶è¡Œçš„çº¿è·¯ã€‚å‰3æ¡çº¿è·¯ä½¿ç”¨çª—å£å¤§å°åˆ†åˆ«æ˜¯<span><span class="MathJax_Preview">1\times 1</span><script type="math/tex">1\times 1</script></span>ã€<span><span class="MathJax_Preview">3\times 3</span><script type="math/tex">3\times 3</script></span>å’Œ<span><span class="MathJax_Preview">5\times 5</span><script type="math/tex">5\times 5</script></span>çš„å·ç§¯å±‚æ¥æŠ½å–ä¸åŒç©ºé—´å°ºå¯¸ä¸‹çš„ä¿¡æ¯ï¼Œå…¶ä¸­ä¸­é—´2ä¸ªçº¿è·¯ä¼šå¯¹è¾“å…¥å…ˆåš<span><span class="MathJax_Preview">1\times 1</span><script type="math/tex">1\times 1</script></span>å·ç§¯æ¥å‡å°‘è¾“å…¥é€šé“æ•°ï¼Œä»¥é™ä½æ¨¡å‹å¤æ‚åº¦ã€‚ç¬¬4æ¡çº¿è·¯åˆ™ä½¿ç”¨<span><span class="MathJax_Preview">3\times 3</span><script type="math/tex">3\times 3</script></span>æœ€å¤§æ± åŒ–å±‚ï¼Œåæ¥<span><span class="MathJax_Preview">1\times 1</span><script type="math/tex">1\times 1</script></span>å·ç§¯å±‚æ¥æ”¹å˜é€šé“æ•°ã€‚4æ¡çº¿è·¯éƒ½ä½¿ç”¨äº†åˆé€‚çš„å¡«å……æ¥ä½¿è¾“å…¥ä¸è¾“å‡ºçš„é«˜å’Œå®½ä¸€è‡´ã€‚æœ€åæˆ‘ä»¬å°†æ¯æ¡çº¿è·¯çš„è¾“å‡ºåœ¨é€šé“ç»´ä¸Šè¿ç»“,å¹¶å‘åè¿›è¡Œä¼ è¾“ã€‚</p>
<p><strong><span><span class="MathJax_Preview">1\times 1</span><script type="math/tex">1\times 1</script></span>å·ç§¯</strong>ï¼š</p>
<p>å®ƒçš„è®¡ç®—æ–¹æ³•å’Œå…¶ä»–å·ç§¯æ ¸ä¸€æ ·ï¼Œå”¯ä¸€ä¸åŒçš„æ˜¯å®ƒçš„å¤§å°æ˜¯<span><span class="MathJax_Preview">1\times1</span><script type="math/tex">1\times1</script></span>ï¼Œæ²¡æœ‰è€ƒè™‘åœ¨ç‰¹å¾å›¾å±€éƒ¨ä¿¡æ¯ä¹‹é—´çš„å…³ç³»ã€‚</p>
<p><img alt="image-20200810103657759" src="../assets/image-20200810103657759.png" /></p>
<p>å®ƒçš„ä½œç”¨ä¸»è¦æ˜¯ï¼š</p>
<ul>
<li>å®ç°è·¨é€šé“çš„äº¤äº’å’Œä¿¡æ¯æ•´åˆ</li>
<li>å·ç§¯æ ¸é€šé“æ•°çš„é™ç»´å’Œå‡ç»´ï¼Œå‡å°‘ç½‘ç»œå‚æ•°</li>
</ul>
<p>ã€æ‰©å±•ğŸ“šï¼šä¸ºä»€ä¹ˆ1x1å·ç§¯å¯ä»¥å‡å°‘ç½‘ç»œå‚æ•°ï¼Ÿã€‘</p>
<p>ä»¥inceptionæ¨¡å—ä¸ºä¾‹ï¼Œæ¥è¯´æ˜1x1çš„å·ç§¯å¦‚ä½•æ¥å‡å°‘æ¨¡å‹å‚æ•°ï¼š</p>
<p><img alt="image-20210129113655281" src="../assets/image-20210129113655281.png" /></p>
<p>(a)æ˜¯æœªåŠ å…¥1x1å·ç§¯çš„inceptionæ¨¡å—ï¼Œ(b)æ˜¯åŠ å…¥äº†1x1 å·ç§¯çš„inceptionæ¨¡å—ã€‚</p>
<p>æˆ‘ä»¬ä»¥3x3å·ç§¯çº¿è·¯ä¸ºä¾‹ï¼Œå‡è®¾è¾“å…¥çš„ç‰¹å¾å›¾å¤§å°ä¸ºï¼ˆ28x28x192ï¼‰ï¼Œè¾“å‡ºç‰¹å¾å›¾çš„é€šé“æ•°æ˜¯128ï¼š</p>
<p>(a)å›¾ä¸­è¯¥çº¿è·¯çš„å‚æ•°é‡ä¸ºï¼š3x3x192x128 = 221184</p>
<p>(b)å›¾ä¸­åŠ å…¥1x1å·ç§¯åé€šé“ä¸º96ï¼Œå†é€å…¥3x3å·ç§¯ä¸­çš„å‚æ•°é‡ä¸ºï¼š(1x1x192x96)+(3x3x96x128)=129024.</p>
<p>å¯¹æ¯”å¯çŸ¥ï¼ŒåŠ å…¥1x1å·ç§¯åå‚æ•°é‡å‡å°‘äº†ã€‚</p>
<p>åœ¨tf.kerasä¸­å®ç°Inceptionæ¨¡å—ï¼Œå„ä¸ªå·ç§¯å±‚å·ç§¯æ ¸çš„ä¸ªæ•°é€šè¿‡è¾“å…¥å‚æ•°æ¥æ§åˆ¶ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<div class="highlight"><pre><span></span><code><span class="c1"># å®šä¹‰Inceptionæ¨¡å—</span>
<span class="k">class</span> <span class="nc">Inception</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Layer</span><span class="p">):</span>
    <span class="c1"># è¾“å…¥å‚æ•°ä¸ºå„ä¸ªå·ç§¯çš„å·ç§¯æ ¸ä¸ªæ•°</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">,</span> <span class="n">c3</span><span class="p">,</span> <span class="n">c4</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="c1"># çº¿è·¯1ï¼š1 x 1å·ç§¯å±‚ï¼Œæ¿€æ´»å‡½æ•°æ˜¯RELUï¼Œpaddingæ˜¯same</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">p1_1</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Conv2D</span><span class="p">(</span>
            <span class="n">c1</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">)</span>
        <span class="c1"># çº¿è·¯2ï¼Œ1 x 1å·ç§¯å±‚åæ¥3 x 3å·ç§¯å±‚,æ¿€æ´»å‡½æ•°æ˜¯RELUï¼Œpaddingæ˜¯same</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">p2_1</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Conv2D</span><span class="p">(</span>
            <span class="n">c2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">kernel_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">p2_2</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Conv2D</span><span class="p">(</span><span class="n">c2</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">kernel_size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">,</span>
                                           <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">)</span>
        <span class="c1"># çº¿è·¯3ï¼Œ1 x 1å·ç§¯å±‚åæ¥5 x 5å·ç§¯å±‚,æ¿€æ´»å‡½æ•°æ˜¯RELUï¼Œpaddingæ˜¯same</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">p3_1</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Conv2D</span><span class="p">(</span>
            <span class="n">c3</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">kernel_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">p3_2</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Conv2D</span><span class="p">(</span><span class="n">c3</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">kernel_size</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">,</span>
                                           <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">)</span>
        <span class="c1"># çº¿è·¯4ï¼Œ3 x 3æœ€å¤§æ± åŒ–å±‚åæ¥1 x 1å·ç§¯å±‚,æ¿€æ´»å‡½æ•°æ˜¯RELUï¼Œpaddingæ˜¯same</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">p4_1</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">MaxPool2D</span><span class="p">(</span>
            <span class="n">pool_size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">,</span> <span class="n">strides</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">p4_2</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Conv2D</span><span class="p">(</span>
            <span class="n">c4</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">)</span>
    <span class="c1"># å®Œæˆå‰å‘ä¼ æ’­è¿‡ç¨‹</span>
    <span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="c1"># çº¿è·¯1</span>
        <span class="n">p1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">p1_1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="c1"># çº¿è·¯2</span>
        <span class="n">p2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">p2_2</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p2_1</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="c1"># çº¿è·¯3</span>
        <span class="n">p3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">p3_2</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p3_1</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="c1"># çº¿è·¯4</span>
        <span class="n">p4</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">p4_2</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p4_1</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="c1"># åœ¨é€šé“ç»´ä¸Šconcatè¾“å‡º</span>
        <span class="n">outputs</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">p3</span><span class="p">,</span> <span class="n">p4</span><span class="p">],</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">outputs</span>  
</code></pre></div>
<p>æŒ‡å®šé€šé“æ•°ï¼Œå¯¹Inceptionæ¨¡å—è¿›è¡Œå®ä¾‹åŒ–ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="n">Inception</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="p">(</span><span class="mi">96</span><span class="p">,</span> <span class="mi">128</span><span class="p">),</span> <span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">32</span><span class="p">),</span> <span class="mi">32</span><span class="p">)</span>
</code></pre></div>
<h2 id="2googlenet">2.GoogLeNetæ¨¡å‹<a class="headerlink" href="#2googlenet" title="Permanent link">&para;</a></h2>
<p>GoogLeNetä¸»è¦ç”±Inceptionæ¨¡å—æ„æˆï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img alt="image-20200810110148039" src="../assets/image-20200810110148039.png" /></p>
<p>æ•´ä¸ªç½‘ç»œæ¶æ„æˆ‘ä»¬åˆ†ä¸ºäº”ä¸ªæ¨¡å—ï¼Œæ¯ä¸ªæ¨¡å—ä¹‹é—´ä½¿ç”¨æ­¥å¹…ä¸º2çš„<span><span class="MathJax_Preview">3\times 3</span><script type="math/tex">3\times 3</script></span>æœ€å¤§æ± åŒ–å±‚æ¥å‡å°è¾“å‡ºé«˜å®½ã€‚</p>
<p><img alt="image-20200810112516071" src="../assets/image-20200810112516071.png" /></p>
<p>ã€æ‰©å±•ğŸ“šï¼šgoogLeNetçš„ç½‘ç»œè®¾è®¡ã€‘</p>
<p><img alt="googleå‚æ•°" src="../assets/google%E5%8F%82%E6%95%B0.jpg" /></p>
<h3 id="21-b1">2.1 B1æ¨¡å—<a class="headerlink" href="#21-b1" title="Permanent link">&para;</a></h3>
<p>ç¬¬ä¸€æ¨¡å—ä½¿ç”¨ä¸€ä¸ª64é€šé“çš„<span><span class="MathJax_Preview">7\times 7</span><script type="math/tex">7\times 7</script></span>å·ç§¯å±‚ã€‚</p>
<div class="highlight"><pre><span></span><code><span class="c1"># å®šä¹‰æ¨¡å‹çš„è¾“å…¥</span>
<span class="n">inputs</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">224</span><span class="p">,</span><span class="mi">224</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;input&quot;</span><span class="p">)</span>
<span class="c1"># b1 æ¨¡å—</span>
<span class="c1"># å·ç§¯å±‚7*7çš„å·ç§¯æ ¸ï¼Œæ­¥é•¿ä¸º2ï¼Œpadæ˜¯sameï¼Œæ¿€æ´»å‡½æ•°RELU</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Conv2D</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">strides</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">)(</span><span class="n">inputs</span><span class="p">)</span>
<span class="c1"># æœ€å¤§æ± åŒ–ï¼šçª—å£å¤§å°ä¸º3*3ï¼Œæ­¥é•¿ä¸º2ï¼Œpadæ˜¯same</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">MaxPool2D</span><span class="p">(</span><span class="n">pool_size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">strides</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<span class="c1"># b2 æ¨¡å—</span>
</code></pre></div>
<h3 id="22-b2">2.2 B2æ¨¡å—<a class="headerlink" href="#22-b2" title="Permanent link">&para;</a></h3>
<p>ç¬¬äºŒæ¨¡å—ä½¿ç”¨2ä¸ªå·ç§¯å±‚ï¼šé¦–å…ˆæ˜¯64é€šé“çš„<span><span class="MathJax_Preview">1\times 1</span><script type="math/tex">1\times 1</script></span>å·ç§¯å±‚ï¼Œç„¶åæ˜¯å°†é€šé“å¢å¤§3å€çš„<span><span class="MathJax_Preview">3\times 3</span><script type="math/tex">3\times 3</script></span>å·ç§¯å±‚ã€‚</p>
<div class="highlight"><pre><span></span><code><span class="c1"># b2 æ¨¡å—</span>
<span class="c1"># å·ç§¯å±‚1*1çš„å·ç§¯æ ¸ï¼Œæ­¥é•¿ä¸º2ï¼Œpadæ˜¯sameï¼Œæ¿€æ´»å‡½æ•°RELU</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Conv2D</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<span class="c1"># å·ç§¯å±‚3*3çš„å·ç§¯æ ¸ï¼Œæ­¥é•¿ä¸º2ï¼Œpadæ˜¯sameï¼Œæ¿€æ´»å‡½æ•°RELU</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Conv2D</span><span class="p">(</span><span class="mi">192</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<span class="c1"># æœ€å¤§æ± åŒ–ï¼šçª—å£å¤§å°ä¸º3*3ï¼Œæ­¥é•¿ä¸º2ï¼Œpadæ˜¯same</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">MaxPool2D</span><span class="p">(</span><span class="n">pool_size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">strides</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div>
<h3 id="23-b3">2.3 B3æ¨¡å—<a class="headerlink" href="#23-b3" title="Permanent link">&para;</a></h3>
<p>ç¬¬ä¸‰æ¨¡å—ä¸²è”2ä¸ªå®Œæ•´çš„Inceptionå—ã€‚ç¬¬ä¸€ä¸ªInceptionå—çš„è¾“å‡ºé€šé“æ•°ä¸º<span><span class="MathJax_Preview">64+128+32+32=256</span><script type="math/tex">64+128+32+32=256</script></span>ã€‚ç¬¬äºŒä¸ªInceptionå—è¾“å‡ºé€šé“æ•°å¢è‡³<span><span class="MathJax_Preview">128+192+96+64=480</span><script type="math/tex">128+192+96+64=480</script></span>ã€‚</p>
<div class="highlight"><pre><span></span><code><span class="c1"># b3 æ¨¡å—</span>
<span class="c1"># Inception</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">Inception</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="p">(</span><span class="mi">96</span><span class="p">,</span> <span class="mi">128</span><span class="p">),</span> <span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">32</span><span class="p">),</span> <span class="mi">32</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<span class="c1"># Inception</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">Inception</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="mi">192</span><span class="p">),</span> <span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">96</span><span class="p">),</span> <span class="mi">64</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<span class="c1"># æœ€å¤§æ± åŒ–ï¼šçª—å£å¤§å°ä¸º3*3ï¼Œæ­¥é•¿ä¸º2ï¼Œpadæ˜¯same</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">MaxPool2D</span><span class="p">(</span><span class="n">pool_size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">strides</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div>
<h3 id="24-b4">2.4 B4æ¨¡å—<a class="headerlink" href="#24-b4" title="Permanent link">&para;</a></h3>
<p>ç¬¬å››æ¨¡å—æ›´åŠ å¤æ‚ã€‚å®ƒä¸²è”äº†5ä¸ªInceptionå—ï¼Œå…¶è¾“å‡ºé€šé“æ•°åˆ†åˆ«æ˜¯<span><span class="MathJax_Preview">192+208+48+64=512</span><script type="math/tex">192+208+48+64=512</script></span>ã€<span><span class="MathJax_Preview">160+224+64+64=512</span><script type="math/tex">160+224+64+64=512</script></span>ã€<span><span class="MathJax_Preview">128+256+64+64=512</span><script type="math/tex">128+256+64+64=512</script></span>ã€<span><span class="MathJax_Preview">112+288+64+64=528</span><script type="math/tex">112+288+64+64=528</script></span>å’Œ<span><span class="MathJax_Preview">256+320+128+128=832</span><script type="math/tex">256+320+128+128=832</script></span>ã€‚å¹¶ä¸”å¢åŠ äº†è¾…åŠ©åˆ†ç±»å™¨ï¼Œæ ¹æ®å®éªŒå‘ç°ç½‘ç»œçš„ä¸­é—´å±‚å…·æœ‰å¾ˆå¼ºçš„è¯†åˆ«èƒ½åŠ›ï¼Œä¸ºäº†åˆ©ç”¨ä¸­é—´å±‚æŠ½è±¡çš„ç‰¹å¾ï¼Œåœ¨æŸäº›ä¸­é—´å±‚ä¸­æ·»åŠ å«æœ‰å¤šå±‚çš„åˆ†ç±»å™¨ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img alt="image-20200810140935549" src="../assets/image-20200810140935549.png" /></p>
<p>å®ç°å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">aux_classifier</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">filter_size</span><span class="p">):</span>
    <span class="c1">#x:è¾“å…¥æ•°æ®ï¼Œfilter_size:å·ç§¯å±‚å·ç§¯æ ¸ä¸ªæ•°ï¼Œå…¨è¿æ¥å±‚ç¥ç»å…ƒä¸ªæ•°</span>
    <span class="c1"># æ± åŒ–å±‚</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">AveragePooling2D</span><span class="p">(</span>
        <span class="n">pool_size</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">strides</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
    <span class="c1"># 1x1 å·ç§¯å±‚</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Conv2D</span><span class="p">(</span><span class="n">filters</span><span class="o">=</span><span class="n">filter_size</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">kernel_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">strides</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                               <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;valid&#39;</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
    <span class="c1"># å±•å¹³</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Flatten</span><span class="p">()(</span><span class="n">x</span><span class="p">)</span>
    <span class="c1"># å…¨è¿æ¥å±‚1</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">units</span><span class="o">=</span><span class="n">filter_size</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
    <span class="c1"># softmaxè¾“å‡ºå±‚</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">units</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;softmax&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">x</span>
</code></pre></div>
<p>b4æ¨¡å—çš„å®ç°ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="c1"># b4 æ¨¡å—</span>
<span class="c1"># Inception</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">Inception</span><span class="p">(</span><span class="mi">192</span><span class="p">,</span> <span class="p">(</span><span class="mi">96</span><span class="p">,</span> <span class="mi">208</span><span class="p">),</span> <span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">48</span><span class="p">),</span> <span class="mi">64</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<span class="c1"># è¾…åŠ©è¾“å‡º1</span>
<span class="n">aux_output_1</span> <span class="o">=</span> <span class="n">aux_classifier</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">[</span><span class="mi">128</span><span class="p">,</span> <span class="mi">1024</span><span class="p">])</span>
<span class="c1"># Inception</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">Inception</span><span class="p">(</span><span class="mi">160</span><span class="p">,</span> <span class="p">(</span><span class="mi">112</span><span class="p">,</span> <span class="mi">224</span><span class="p">),</span> <span class="p">(</span><span class="mi">24</span><span class="p">,</span> <span class="mi">64</span><span class="p">),</span> <span class="mi">64</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<span class="c1"># Inception</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">Inception</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="mi">256</span><span class="p">),</span> <span class="p">(</span><span class="mi">24</span><span class="p">,</span> <span class="mi">64</span><span class="p">),</span> <span class="mi">64</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<span class="c1"># Inception</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">Inception</span><span class="p">(</span><span class="mi">112</span><span class="p">,</span> <span class="p">(</span><span class="mi">144</span><span class="p">,</span> <span class="mi">288</span><span class="p">),</span> <span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">64</span><span class="p">),</span> <span class="mi">64</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<span class="c1"># è¾…åŠ©è¾“å‡º2</span>
<span class="n">aux_output_2</span> <span class="o">=</span> <span class="n">aux_classifier</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">[</span><span class="mi">128</span><span class="p">,</span> <span class="mi">1024</span><span class="p">])</span>
<span class="c1"># Inception</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">Inception</span><span class="p">(</span><span class="mi">256</span><span class="p">,</span> <span class="p">(</span><span class="mi">160</span><span class="p">,</span> <span class="mi">320</span><span class="p">),</span> <span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">128</span><span class="p">),</span> <span class="mi">128</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<span class="c1"># æœ€å¤§æ± åŒ–</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">MaxPool2D</span><span class="p">(</span><span class="n">pool_size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">strides</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div>
<h3 id="25-b5">2.5 B5æ¨¡å—<a class="headerlink" href="#25-b5" title="Permanent link">&para;</a></h3>
<p>ç¬¬äº”æ¨¡å—æœ‰è¾“å‡ºé€šé“æ•°ä¸º<span><span class="MathJax_Preview">256+320+128+128=832</span><script type="math/tex">256+320+128+128=832</script></span>å’Œ<span><span class="MathJax_Preview">384+384+128+128=1024</span><script type="math/tex">384+384+128+128=1024</script></span>çš„ä¸¤ä¸ªInceptionå—ã€‚åé¢ç´§è·Ÿè¾“å‡ºå±‚ï¼Œè¯¥æ¨¡å—ä½¿ç”¨å…¨å±€å¹³å‡æ± åŒ–å±‚ï¼ˆGAPï¼‰æ¥å°†æ¯ä¸ªé€šé“çš„é«˜å’Œå®½å˜æˆ1ã€‚æœ€åè¾“å‡ºå˜æˆäºŒç»´æ•°ç»„åæ¥è¾“å‡ºä¸ªæ•°ä¸ºæ ‡ç­¾ç±»åˆ«æ•°çš„å…¨è¿æ¥å±‚ã€‚</p>
<p><strong>å…¨å±€å¹³å‡æ± åŒ–å±‚ï¼ˆGAPï¼‰</strong></p>
<p>ç”¨æ¥æ›¿ä»£å…¨è¿æ¥å±‚å‰çš„Flattenï¼Œå°†ç‰¹å¾å›¾æ¯ä¸€é€šé“ä¸­æ‰€æœ‰åƒç´ å€¼ç›¸åŠ åæ±‚å¹³å‡ï¼Œå¾—åˆ°å°±æ˜¯GAPçš„ç»“æœï¼Œåœ¨å°†å…¶é€å…¥åç»­ç½‘ç»œä¸­è¿›è¡Œè®¡ç®—</p>
<p><img alt="image-20200810130708604" src="../assets/image-20200810130708604.png" /></p>
<p>å®ç°è¿‡ç¨‹æ˜¯ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="c1"># b5 æ¨¡å—</span>
<span class="c1"># Inception</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">Inception</span><span class="p">(</span><span class="mi">256</span><span class="p">,</span> <span class="p">(</span><span class="mi">160</span><span class="p">,</span> <span class="mi">320</span><span class="p">),</span> <span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">128</span><span class="p">),</span> <span class="mi">128</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<span class="c1"># Inception</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">Inception</span><span class="p">(</span><span class="mi">384</span><span class="p">,</span> <span class="p">(</span><span class="mi">192</span><span class="p">,</span> <span class="mi">384</span><span class="p">),</span> <span class="p">(</span><span class="mi">48</span><span class="p">,</span> <span class="mi">128</span><span class="p">),</span> <span class="mi">128</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<span class="c1"># GAP</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">GlobalAvgPool2D</span><span class="p">()(</span><span class="n">x</span><span class="p">)</span>
<span class="c1"># è¾“å‡ºå±‚</span>
<span class="n">main_outputs</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="n">activation</span><span class="o">=</span><span class="s1">&#39;softmax&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<span class="c1"># ä½¿ç”¨Modelæ¥åˆ›å»ºæ¨¡å‹ï¼ŒæŒ‡æ˜è¾“å…¥å’Œè¾“å‡º</span>
</code></pre></div>
<p>æ„å»ºGoogLeNetæ¨¡å‹å¹¶é€šè¿‡summaryæ¥çœ‹ä¸‹æ¨¡å‹çš„ç»“æ„ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="c1"># ä½¿ç”¨Modelæ¥åˆ›å»ºæ¨¡å‹ï¼ŒæŒ‡æ˜è¾“å…¥å’Œè¾“å‡º</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">inputs</span><span class="o">=</span><span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span><span class="o">=</span><span class="p">[</span><span class="n">main_outputs</span><span class="p">,</span><span class="n">aux_output_1</span><span class="err">ï¼Œ</span><span class="n">aux_output_2</span><span class="p">])</span> 
<span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">Model</span><span class="p">:</span> <span class="s2">&quot;functional_3&quot;</span>
<span class="n">_________________________________________________________________</span>
<span class="n">Layer</span> <span class="p">(</span><span class="nb">type</span><span class="p">)</span>                 <span class="n">Output</span> <span class="n">Shape</span>              <span class="n">Param</span> <span class="c1">#   </span>
<span class="o">=================================================================</span>
<span class="nb">input</span> <span class="p">(</span><span class="n">InputLayer</span><span class="p">)</span>           <span class="p">[(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">224</span><span class="p">,</span> <span class="mi">224</span><span class="p">,</span> <span class="mi">3</span><span class="p">)]</span>     <span class="mi">0</span>         
<span class="n">_________________________________________________________________</span>
<span class="n">conv2d_122</span> <span class="p">(</span><span class="n">Conv2D</span><span class="p">)</span>          <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">112</span><span class="p">,</span> <span class="mi">112</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>      <span class="mi">9472</span>      
<span class="n">_________________________________________________________________</span>
<span class="n">max_pooling2d_27</span> <span class="p">(</span><span class="n">MaxPooling</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>        <span class="mi">0</span>         
<span class="n">_________________________________________________________________</span>
<span class="n">conv2d_123</span> <span class="p">(</span><span class="n">Conv2D</span><span class="p">)</span>          <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>        <span class="mi">4160</span>      
<span class="n">_________________________________________________________________</span>
<span class="n">conv2d_124</span> <span class="p">(</span><span class="n">Conv2D</span><span class="p">)</span>          <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="mi">192</span><span class="p">)</span>       <span class="mi">110784</span>    
<span class="n">_________________________________________________________________</span>
<span class="n">max_pooling2d_28</span> <span class="p">(</span><span class="n">MaxPooling</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">192</span><span class="p">)</span>       <span class="mi">0</span>         
<span class="n">_________________________________________________________________</span>
<span class="n">inception_19</span> <span class="p">(</span><span class="n">Inception</span><span class="p">)</span>     <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">256</span><span class="p">)</span>       <span class="mi">163696</span>    
<span class="n">_________________________________________________________________</span>
<span class="n">inception_20</span> <span class="p">(</span><span class="n">Inception</span><span class="p">)</span>     <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">480</span><span class="p">)</span>       <span class="mi">388736</span>    
<span class="n">_________________________________________________________________</span>
<span class="n">max_pooling2d_31</span> <span class="p">(</span><span class="n">MaxPooling</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">480</span><span class="p">)</span>       <span class="mi">0</span>         
<span class="n">_________________________________________________________________</span>
<span class="n">inception_21</span> <span class="p">(</span><span class="n">Inception</span><span class="p">)</span>     <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">512</span><span class="p">)</span>       <span class="mi">376176</span>    
<span class="n">_________________________________________________________________</span>
<span class="n">inception_22</span> <span class="p">(</span><span class="n">Inception</span><span class="p">)</span>     <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">512</span><span class="p">)</span>       <span class="mi">449160</span>    
<span class="n">_________________________________________________________________</span>
<span class="n">inception_23</span> <span class="p">(</span><span class="n">Inception</span><span class="p">)</span>     <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">512</span><span class="p">)</span>       <span class="mi">510104</span>    
<span class="n">_________________________________________________________________</span>
<span class="n">inception_24</span> <span class="p">(</span><span class="n">Inception</span><span class="p">)</span>     <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">528</span><span class="p">)</span>       <span class="mi">605376</span>    
<span class="n">_________________________________________________________________</span>
<span class="n">inception_25</span> <span class="p">(</span><span class="n">Inception</span><span class="p">)</span>     <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">832</span><span class="p">)</span>       <span class="mi">868352</span>    
<span class="n">_________________________________________________________________</span>
<span class="n">max_pooling2d_37</span> <span class="p">(</span><span class="n">MaxPooling</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">832</span><span class="p">)</span>         <span class="mi">0</span>         
<span class="n">_________________________________________________________________</span>
<span class="n">inception_26</span> <span class="p">(</span><span class="n">Inception</span><span class="p">)</span>     <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">832</span><span class="p">)</span>         <span class="mi">1043456</span>   
<span class="n">_________________________________________________________________</span>
<span class="n">inception_27</span> <span class="p">(</span><span class="n">Inception</span><span class="p">)</span>     <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1024</span><span class="p">)</span>        <span class="mi">1444080</span>   
<span class="n">_________________________________________________________________</span>
<span class="n">global_average_pooling2d_2</span> <span class="p">(</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">1024</span><span class="p">)</span>              <span class="mi">0</span>         
<span class="n">_________________________________________________________________</span>
<span class="n">dense_10</span> <span class="p">(</span><span class="n">Dense</span><span class="p">)</span>             <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>                <span class="mi">10250</span>     
<span class="o">=================================================================</span>
<span class="n">Total</span> <span class="n">params</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span><span class="mi">983</span><span class="p">,</span><span class="mi">802</span>
<span class="n">Trainable</span> <span class="n">params</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span><span class="mi">983</span><span class="p">,</span><span class="mi">802</span>
<span class="n">Non</span><span class="o">-</span><span class="n">trainable</span> <span class="n">params</span><span class="p">:</span> <span class="mi">0</span>
<span class="n">___________________________________________________________</span>
</code></pre></div>
<h2 id="3">3.æ‰‹å†™æ•°å­—è¯†åˆ«<a class="headerlink" href="#3" title="Permanent link">&para;</a></h2>
<p>å› ä¸ºImageNetæ•°æ®é›†è¾ƒå¤§è®­ç»ƒæ—¶é—´è¾ƒé•¿ï¼Œæˆ‘ä»¬ä»ç”¨å‰é¢çš„MNISTæ•°æ®é›†æ¥æ¼”ç¤ºGoogLeNetã€‚è¯»å–æ•°æ®çš„æ—¶å°†å›¾åƒé«˜å’Œå®½æ‰©å¤§åˆ°å›¾åƒé«˜å’Œå®½224ã€‚è¿™ä¸ªé€šè¿‡<code>tf.image.resize_with_pad</code>æ¥å®ç°ã€‚</p>
<h3 id="21">2.1 æ•°æ®è¯»å–<a class="headerlink" href="#21" title="Permanent link">&para;</a></h3>
<p>é¦–å…ˆè·å–æ•°æ®,å¹¶è¿›è¡Œç»´åº¦è°ƒæ•´ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="c1"># è·å–æ‰‹å†™æ•°å­—æ•°æ®é›†</span>
<span class="p">(</span><span class="n">train_images</span><span class="p">,</span> <span class="n">train_labels</span><span class="p">),</span> <span class="p">(</span><span class="n">test_images</span><span class="p">,</span> <span class="n">test_labels</span><span class="p">)</span> <span class="o">=</span> <span class="n">mnist</span><span class="o">.</span><span class="n">load_data</span><span class="p">()</span>
<span class="c1"># è®­ç»ƒé›†æ•°æ®ç»´åº¦çš„è°ƒæ•´ï¼šN H W C</span>
<span class="n">train_images</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">train_images</span><span class="p">,(</span><span class="n">train_images</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">train_images</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">train_images</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="mi">1</span><span class="p">))</span>
<span class="c1"># æµ‹è¯•é›†æ•°æ®ç»´åº¦çš„è°ƒæ•´ï¼šN H W C</span>
<span class="n">test_images</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">test_images</span><span class="p">,(</span><span class="n">test_images</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">test_images</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">test_images</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="mi">1</span><span class="p">))</span>
</code></pre></div>
<p>ç”±äºä½¿ç”¨å…¨éƒ¨æ•°æ®è®­ç»ƒæ—¶é—´è¾ƒé•¿ï¼Œæˆ‘ä»¬å®šä¹‰ä¸¤ä¸ªæ–¹æ³•è·å–éƒ¨åˆ†æ•°æ®ï¼Œå¹¶å°†å›¾åƒè°ƒæ•´ä¸º224*224å¤§å°ï¼Œè¿›è¡Œæ¨¡å‹è®­ç»ƒï¼š(ä¸VGGä¸­æ˜¯ä¸€æ ·çš„)</p>
<div class="highlight"><pre><span></span><code><span class="c1"># å®šä¹‰ä¸¤ä¸ªæ–¹æ³•éšæœºæŠ½å–éƒ¨åˆ†æ ·æœ¬æ¼”ç¤º</span>
<span class="c1"># è·å–è®­ç»ƒé›†æ•°æ®</span>
<span class="k">def</span> <span class="nf">get_train</span><span class="p">(</span><span class="n">size</span><span class="p">):</span>
    <span class="c1"># éšæœºç”Ÿæˆè¦æŠ½æ ·çš„æ ·æœ¬çš„ç´¢å¼•</span>
    <span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">train_images</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">size</span><span class="p">)</span>
    <span class="c1"># å°†è¿™äº›æ•°æ®resizeæˆ22*227å¤§å°</span>
    <span class="n">resized_images</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">resize_with_pad</span><span class="p">(</span><span class="n">train_images</span><span class="p">[</span><span class="n">index</span><span class="p">],</span><span class="mi">224</span><span class="p">,</span><span class="mi">224</span><span class="p">,)</span>
    <span class="c1"># è¿”å›æŠ½å–çš„</span>
    <span class="k">return</span> <span class="n">resized_images</span><span class="o">.</span><span class="n">numpy</span><span class="p">(),</span> <span class="n">train_labels</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
<span class="c1"># è·å–æµ‹è¯•é›†æ•°æ® </span>
<span class="k">def</span> <span class="nf">get_test</span><span class="p">(</span><span class="n">size</span><span class="p">):</span>
    <span class="c1"># éšæœºç”Ÿæˆè¦æŠ½æ ·çš„æ ·æœ¬çš„ç´¢å¼•</span>
    <span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">test_images</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">size</span><span class="p">)</span>
    <span class="c1"># å°†è¿™äº›æ•°æ®resizeæˆ224*224å¤§å°</span>
    <span class="n">resized_images</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">resize_with_pad</span><span class="p">(</span><span class="n">test_images</span><span class="p">[</span><span class="n">index</span><span class="p">],</span><span class="mi">224</span><span class="p">,</span><span class="mi">224</span><span class="p">,)</span>
    <span class="c1"># è¿”å›æŠ½æ ·çš„æµ‹è¯•æ ·æœ¬</span>
    <span class="k">return</span> <span class="n">resized_images</span><span class="o">.</span><span class="n">numpy</span><span class="p">(),</span> <span class="n">test_labels</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
</code></pre></div>
<p>è°ƒç”¨ä¸Šè¿°ä¸¤ä¸ªæ–¹æ³•ï¼Œè·å–å‚ä¸æ¨¡å‹è®­ç»ƒå’Œæµ‹è¯•çš„æ•°æ®é›†ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="c1"># è·å–è®­ç»ƒæ ·æœ¬å’Œæµ‹è¯•æ ·æœ¬</span>
<span class="n">train_images</span><span class="p">,</span><span class="n">train_labels</span> <span class="o">=</span> <span class="n">get_train</span><span class="p">(</span><span class="mi">256</span><span class="p">)</span>
<span class="n">test_images</span><span class="p">,</span><span class="n">test_labels</span> <span class="o">=</span> <span class="n">get_test</span><span class="p">(</span><span class="mi">128</span><span class="p">)</span>
</code></pre></div>
<h3 id="32">3.2 æ¨¡å‹ç¼–è¯‘<a class="headerlink" href="#32" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># æŒ‡å®šä¼˜åŒ–å™¨ï¼ŒæŸå¤±å‡½æ•°å’Œè¯„ä»·æŒ‡æ ‡</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">optimizers</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">momentum</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
<span class="c1"># æ¨¡å‹æœ‰3ä¸ªè¾“å‡ºï¼Œæ‰€ä»¥æŒ‡å®šæŸå¤±å‡½æ•°å¯¹åº”çš„æƒé‡ç³»æ•°</span>
<span class="n">net</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="n">optimizer</span><span class="p">,</span>
              <span class="n">loss</span><span class="o">=</span><span class="s1">&#39;sparse_categorical_crossentropy&#39;</span><span class="p">,</span>
              <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">],</span><span class="n">loss_weights</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.3</span><span class="p">])</span>
</code></pre></div>
<h3 id="33">3.3 æ¨¡å‹è®­ç»ƒ<a class="headerlink" href="#33" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># æ¨¡å‹è®­ç»ƒï¼šæŒ‡å®šè®­ç»ƒæ•°æ®ï¼Œbatchsize,epoch,éªŒè¯é›†</span>
<span class="n">net</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_images</span><span class="p">,</span><span class="n">train_labels</span><span class="p">,</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span><span class="n">epochs</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">validation_split</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
</code></pre></div>
<p>è®­ç»ƒè¿‡ç¨‹ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="n">Epoch</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span>
<span class="mi">2</span><span class="o">/</span><span class="mi">2</span> <span class="p">[</span><span class="o">==============================</span><span class="p">]</span> <span class="o">-</span> <span class="mi">8</span><span class="n">s</span> <span class="mi">4</span><span class="n">s</span><span class="o">/</span><span class="n">step</span> <span class="o">-</span> <span class="n">loss</span><span class="p">:</span> <span class="mf">2.9527</span> <span class="o">-</span> <span class="n">accuracy</span><span class="p">:</span> <span class="mf">0.1174</span> <span class="o">-</span> <span class="n">val_loss</span><span class="p">:</span> <span class="mf">3.3254</span> <span class="o">-</span> <span class="n">val_accuracy</span><span class="p">:</span> <span class="mf">0.1154</span>
<span class="n">Epoch</span> <span class="mi">2</span><span class="o">/</span><span class="mi">3</span>
<span class="mi">2</span><span class="o">/</span><span class="mi">2</span> <span class="p">[</span><span class="o">==============================</span><span class="p">]</span> <span class="o">-</span> <span class="mi">7</span><span class="n">s</span> <span class="mi">4</span><span class="n">s</span><span class="o">/</span><span class="n">step</span> <span class="o">-</span> <span class="n">loss</span><span class="p">:</span> <span class="mf">2.8111</span> <span class="o">-</span> <span class="n">accuracy</span><span class="p">:</span> <span class="mf">0.0957</span> <span class="o">-</span> <span class="n">val_loss</span><span class="p">:</span> <span class="mf">2.2718</span> <span class="o">-</span> <span class="n">val_accuracy</span><span class="p">:</span> <span class="mf">0.2308</span>
<span class="n">Epoch</span> <span class="mi">3</span><span class="o">/</span><span class="mi">3</span>
<span class="mi">2</span><span class="o">/</span><span class="mi">2</span> <span class="p">[</span><span class="o">==============================</span><span class="p">]</span> <span class="o">-</span> <span class="mi">7</span><span class="n">s</span> <span class="mi">4</span><span class="n">s</span><span class="o">/</span><span class="n">step</span> <span class="o">-</span> <span class="n">loss</span><span class="p">:</span> <span class="mf">2.3055</span> <span class="o">-</span> <span class="n">accuracy</span><span class="p">:</span> <span class="mf">0.0957</span> <span class="o">-</span> <span class="n">val_loss</span><span class="p">:</span> <span class="mf">2.2669</span> <span class="o">-</span> <span class="n">val_accuracy</span><span class="p">:</span> <span class="mf">0.2308</span>
</code></pre></div>
<h3 id="24">2.4 æ¨¡å‹è¯„ä¼°<a class="headerlink" href="#24" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># æŒ‡å®šæµ‹è¯•æ•°æ®</span>
<span class="n">net</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">test_images</span><span class="p">,</span><span class="n">test_labels</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>
<p>è¾“å‡ºä¸ºï¼š</p>
<div class="highlight"><pre><span></span><code><span class="mi">4</span><span class="o">/</span><span class="mi">4</span> <span class="p">[</span><span class="o">==============================</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="n">s</span> <span class="mi">338</span><span class="n">ms</span><span class="o">/</span><span class="n">step</span> <span class="o">-</span> <span class="n">loss</span><span class="p">:</span> <span class="mf">2.3110</span> <span class="o">-</span> <span class="n">accuracy</span><span class="p">:</span> <span class="mf">0.0781</span>
<span class="p">[</span><span class="mf">2.310971260070801</span><span class="p">,</span> <span class="mf">0.078125</span><span class="p">]</span>
</code></pre></div>
<h2 id="4">4.å»¶ä¼¸ç‰ˆæœ¬<a class="headerlink" href="#4" title="Permanent link">&para;</a></h2>
<p>GoogLeNetæ˜¯ä»¥InceptionV1ä¸ºåŸºç¡€è¿›è¡Œæ„å»ºçš„ï¼Œæ‰€ä»¥GoogLeNetä¹Ÿå«åšInceptionNet,åœ¨éšåçš„â¼å¹´â¾¥ï¼Œç ”ç©¶â¼ˆå‘˜å¯¹GoogLeNetè¿›â¾äº†æ•°æ¬¡æ”¹è¿›ï¼Œ å°±åˆäº§ç”Ÿäº†InceptionV2ï¼ŒV3,V4ç­‰ç‰ˆæœ¬ã€‚</p>
<h3 id="41-inceptionv2">4.1 InceptionV2<a class="headerlink" href="#41-inceptionv2" title="Permanent link">&para;</a></h3>
<p>åœ¨InceptionV2ä¸­å°†å¤§å·ç§¯æ ¸æ‹†åˆ†ä¸ºå°å·ç§¯æ ¸ï¼Œå°†V1ä¸­çš„<span><span class="MathJax_Preview">5\times 5</span><script type="math/tex">5\times 5</script></span>çš„å·ç§¯ç”¨ä¸¤ä¸ª<span><span class="MathJax_Preview">3\times 3</span><script type="math/tex">3\times 3</script></span>çš„å·ç§¯æ›¿ä»£ï¼Œä»è€Œå¢åŠ ç½‘ç»œçš„æ·±åº¦ï¼Œå‡å°‘äº†å‚æ•°ã€‚</p>
<p><img alt="image-20200810144356206" src="../assets/image-20200810144356206.png" /></p>
<h3 id="42-inceptionv3">4.2 InceptionV3<a class="headerlink" href="#42-inceptionv3" title="Permanent link">&para;</a></h3>
<p>å°†nÃ—nå·ç§¯åˆ†å‰²ä¸º1Ã—nå’ŒnÃ—1ä¸¤ä¸ªå·ç§¯ï¼Œä¾‹å¦‚ï¼Œä¸€ä¸ªçš„<span><span class="MathJax_Preview">3\times3</span><script type="math/tex">3\times3</script></span>å·ç§¯é¦–å…ˆæ‰§è¡Œä¸€ä¸ª<span><span class="MathJax_Preview">1\times3</span><script type="math/tex">1\times3</script></span>çš„å·ç§¯ï¼Œç„¶åæ‰§è¡Œä¸€ä¸ª<span><span class="MathJax_Preview">3\times1</span><script type="math/tex">3\times1</script></span>çš„å·ç§¯,è¿™ç§æ–¹æ³•çš„å‚æ•°é‡å’Œè®¡ç®—é‡éƒ½æ¯”åŸæ¥é™ä½ã€‚</p>
<p><img alt="image-20200810145542314" src="../assets/image-20200810145542314.png" /></p>
<hr />
<p><strong>æ€»ç»“</strong></p>
<ul>
<li>çŸ¥é“GoogLeNetçš„ç½‘ç»œæ¶æ„ï¼šæœ‰åŸºç¡€æ¨¡å—Inceptionæ„æˆ</li>
<li>èƒ½å¤Ÿåˆ©ç”¨GoogleNetå®Œæˆå›¾åƒåˆ†ç±»</li>
</ul>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        <a href="../section3/index.html" class="md-footer__link md-footer__link--prev" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              VGG
            </div>
          </div>
        </a>
      
      
        <a href="../section5/index.html" class="md-footer__link md-footer__link--next" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              ResNet
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "../../assets/javascripts/workers/search.d351de03.min.js", "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.a1609d9a.min.js"></script>
      
        <script src="../../js/extra.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
    
  </body>
</html>